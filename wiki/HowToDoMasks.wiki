#summary This page describes an idea how to use lsyncd to sync all local `/home/[user]/www` directories with a remote web server.

= Introduction =

This needs lsyncd version 1.25 that is yet to be released.

= Details =

This can easily be achieved by creating a small script that will dynamically create a [lsyncd.conf.xml] file. This can for example be in python like below. Note that when you add or remove a user, someone (or something) has to kill lsyncd, run this script to recreate a new config file, and restart it. 

{{{
#!/usr/bin/python
import os
print """<lsyncd version="1.25">
<!-- This file is autogenerated by scanhomes.py -->
<settings>
        <logfile      filename="/var/log/lsyncd"/>
        <binary       filename="/usr/bin/rsync"/>
        <pidfile      filename="/var/run/lsyncd.pid"/>
</settings>
"""

target ="remote.host.org::users-www/"
root = "/home/"
suffix = "/www"
names = os.listdir(root)
names.sort()
for entry in names:
        if not os.path.isdir(root + entry):
                continue
        if not os.path.isdir(root + entry + suffix):
                continue
        print "<directory>"
        print "    <source path=\""+ root + entry + suffix + "/\"/>"
        print "    <target path=\""+ target + entry + "/\"/>"
        print "</directory>"

print "</lsyncd>"
}}}